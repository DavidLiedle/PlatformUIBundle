<!doctype html>
<html lang="{{ app.request.locale }}">
<head>
    <title>Editorial application</title>
    <meta charset="utf-8"/>
{% stylesheets
    '@eZEditorialBundle/Resources/public/vendors/pure/base-context-min.css'
    '@eZEditorialBundle/Resources/public/vendors/pure/grids-min.css'
    '@eZEditorialBundle/Resources/public/vendors/pure/buttons-min.css'
    '@eZEditorialBundle/Resources/public/css/layout.css'
    '@eZEditorialBundle/Resources/public/css/contenteditview.css'
    '@eZEditorialBundle/Resources/public/css/locationviewview.css'
    '@eZEditorialBundle/Resources/public/css/contenteditformview.css'
    '@eZEditorialBundle/Resources/public/css/barview.css'
    '@eZEditorialBundle/Resources/public/css/discoverybarview.css'
    '@eZEditorialBundle/Resources/public/css/buttonactionview.css'
    '@eZEditorialBundle/Resources/public/css/previewactionview.css'
    '@eZEditorialBundle/Resources/public/css/editpreviewview.css'
    '@eZEditorialBundle/Resources/public/css/fieldeditview.css'
    '@eZEditorialBundle/Resources/public/css/fields/checkbox-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/textline-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/textblock-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/emailaddress-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/url-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/float-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/integer-editview.css'
    '@eZEditorialBundle/Resources/public/css/fields/maplocation-editview.css'
    '@eZEditorialBundle/Resources/public/css/errorview.css'
    '@eZEditorialBundle/Resources/public/css/tabs.css'
    '@eZEditorialBundle/Resources/public/css/theme.css'
%}
    <link rel="stylesheet" href="{{ asset_url }}"/>
{% endstylesheets %}
    <style>
        .ez-loading-message {
            display: none;
        }

        .yui3-js-enabled .ez-loading-message {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 40px;
            margin-top: 50px;
            text-align: center;
            display: block;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="ez-loading-message"><em>{{ 'Loading the application...'|trans }}</em></div>
    <div class="ez-editorial-app pure is-menu-hidden is-navigation-hidden">
        <div class="ez-navigation-container"></div>
        <div class="ez-mainviews pure-g">
            <div class="ez-menu-container pure-u"></div>
            <div class="ez-view-container pure-u"></div>
        </div>
        <div class="ez-errorview-container is-hidden pure-u"></div>
    </div>

    <noscript>
        <p>{{ 'JavaScript is disabled in your browser but it is required to run the editorial application.'|trans }}</p>
        <p><strong>{{ 'Please enable JavaScript to use the editorial application.'|trans }}</strong></p>
    </noscript>
    <script src="{{ asset( "extension/ezjscore/design/standard/lib/yui/3.14.0/build/yui/yui-min.js" ) }}"></script>
    <script>
        {{ ez_editorial_yui_config( "YUI.GlobalConfig" ) }}

        YUI.GlobalConfig.onSuccess = function (e) {
            for (var i = 0, len = e.data.length; i < len; ++i) {
                if ( e.data[i] === 'ez-capi' ) {
                    YUI.add('ez-capi', function (Y) {
                        Y.namespace('eZ');
                        Y.eZ.CAPI = eZ.CAPI;
                        Y.eZ.SessionAuthAgent = eZ.SessionAuthAgent;
                    });
                }
            }
        };

        YUI().use('ez-editorialapp', function (Y) {
            var app = new Y.eZ.EditorialApp({
                    container: '.ez-editorial-app',
                    viewContainer: '.ez-view-container',
                    root: "{{ app.request.attributes.get( 'semanticPathinfo' ) }}",
                    capi: new Y.eZ.CAPI(
                        "{{ app.request.uriForPath('/')|trim('/') }}",
                        new Y.eZ.SessionAuthAgent({
                            login: "admin",
                            password: "ezpublish"
                        })
                    )
                });

            app.render().dispatch();

            // for now redirecting to the dashboard to boot the application
            if ( !Y.config.doc.location.hash ) {
                Y.config.doc.location.hash = '#/dashboard';
            }
        });
    </script>

{% macro include(tpl, name) %}
<script type="text/x-handlebars-template" id="{{ name }}-ez-template">
{{ source( 'eZEditorialBundle:Editorial/handlebars:' ~ tpl ~ '.twig' ) }}
</script>
{% endmacro %}

{% macro partial(tpl, name) %}
<script type="text/x-handlebars-template" id="{{ name }}" class="ez-editorial-app-partial">
{{ source( 'eZEditorialBundle:Editorial/handlebars/partials/:' ~ tpl ~ '.twig' ) }}
</script>
{% endmacro %}

{% import _self as handlebars %}

{{ handlebars.include( 'dashboardview.handlebars', 'dashboardview' ) }}

{{ handlebars.include( 'locationviewview.handlebars', 'locationviewview' ) }}

{{ handlebars.include( 'contenteditview.handlebars', 'contenteditview' ) }}
{{ handlebars.include( 'contenteditformview.handlebars', 'contenteditformview' ) }}

{{ handlebars.include( 'navigationhubview.handlebars', 'navigationhubview' ) }}

{{ handlebars.include( 'barview.handlebars', 'barview' ) }}
{{ handlebars.include( 'buttonactionview.handlebars', 'buttonactionview' ) }}
{{ handlebars.include( 'previewactionview.handlebars', 'previewactionview' ) }}
{{ handlebars.include( 'editpreviewview.handlebars', 'editpreviewview' ) }}

{{ handlebars.include( 'fields/edit/checkbox.handlebars', 'checkboxeditview' ) }}
{{ handlebars.include( 'fields/edit/textline.handlebars', 'textlineeditview' ) }}
{{ handlebars.include( 'fields/edit/textblock.handlebars', 'textblockeditview' ) }}
{{ handlebars.include( 'fields/edit/emailaddress.handlebars', 'emailaddresseditview' ) }}
{{ handlebars.include( 'fields/edit/url.handlebars', 'urleditview' ) }}
{{ handlebars.include( 'fields/edit/float.handlebars', 'floateditview' ) }}
{{ handlebars.include( 'fields/edit/integer.handlebars', 'integereditview' ) }}
{{ handlebars.include( 'fields/edit/maplocation.handlebars', 'maplocationeditview' ) }}

{{ handlebars.include( 'errorview.handlebars', 'errorview' ) }}

{{ handlebars.partial( 'fieldinfo_tooltip.handlebars', 'ez_fieldinfo_tooltip' ) }}
</body>
</html>
